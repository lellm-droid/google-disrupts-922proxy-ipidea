# Google严厉打击全球最大住宅代理服务商ipidea 922proxy等

## 引言 
2026年1月29日，谷歌与合作伙伴采取行动，成功打击了我们认为全球最大的住宅代理网络之一——IPIDEA代理网络。IPIDEA的代理基础设施是数字生态系统中一个鲜为人知的部分，却被众多恶意行为者广泛利用。  此次打击行动由谷歌威胁情报小组牵头，联合多个团队共同实施，主要包括三项举措： 
*   采取法律行动，关闭用于控制设备和代理流量的相关域名。
*   向平台提供商、执法机构和研究公司共享已发现的IPIDEA软件开发工具包和代理软件的技术情报，以推动整个生态系统的认知与治理。这些SDK通过多个移动和桌面平台提供给开发者，会秘密地将用户设备纳入IPIDEA网络。推动对这些SDK的联合治理，有助于保护整个数字生态系统的用户，并限制该网络的扩张能力。

文章来源请阅读：[Disrupting Largest Residential Proxy NetWork](https://cloud.google.com/blog/topics/threat-intelligence/disrupting-largest-residential-proxy-network)

此次打击行动由谷歌威胁情报小组牵头，联合多个团队共同实施，主要包括三项举措：

*   采取法律行动，关闭用于控制设备和代理流量的相关域名。
*   向平台提供商、执法机构和研究公司共享已发现的IPIDEA软件开发工具包和代理软件的技术情报，以推动整个生态系统的认知与治理。这些SDK通过多个移动和桌面平台提供给开发者，会秘密地将用户设备纳入IPIDEA网络。推动对这些SDK的联合治理，有助于保护整个数字生态系统的用户，并限制该网络的扩张能力。

这些为维护更广泛数字生态系统安全所做的努力，补充了我们在认证设备上保护Android用户已有的防护措施。我们确保Google Play Protect（Android内置安全防护）能自动警告用户并移除已知包含IPIDEA SDK的应用程序，同时阻止未来的任何安装尝试。

我们相信，我们的行动已严重削弱了IPIDEA的代理网络和业务运营，使其代理运营商可用的设备池减少了数百万台。由于代理运营商通过转售协议共享设备池，我们认为这些行动可能对其关联实体产生连锁影响。

## 住宅代理助长的五花八门恶意行为
与其他类型的代理不同，住宅代理网络出售的是通过互联网服务提供商所拥有、用于向住宅或小型企业客户提供服务的IP地址来路由流量的能力。通过将流量路由至遍布全球的众多消费级设备，攻击者可以劫持这些IP地址以掩盖其恶意活动。这给网络防御者检测和阻断恶意活动带来了重大挑战。

一个强大的住宅代理网络需要控制数百万个住宅IP地址，以出售给客户使用。美国、加拿大和欧洲等国家的IP地址尤其抢手。为此，住宅代理网络运营商需要在消费级设备上运行代码，将其注册为网络出口节点。这些设备要么预装了代理软件，要么在用户不知情地下载了嵌有代理代码的木马化应用程序时，加入了代理网络。部分用户可能在"变现闲置带宽"的承诺诱惑下，知情地在其设备上安装此类软件。当设备加入代理网络后，代理提供商便将其受感染设备的网络带宽（及其IP地址使用权）出售给客户。

尽管住宅代理运营商常吹嘘其产品带来的隐私保护和言论自由益处，但谷歌威胁情报小组的研究表明，这些代理绝大多数被恶意行为者滥用。IPIDEA因助长多个僵尸网络而臭名昭著：其软件开发工具包在为僵尸网络添加设备方面起到了关键作用，随后其代理软件又被恶意行为者用于控制这些设备。这包括我们去年采取法律行动打击的BadBox2.0僵尸网络，以及更近期的Aisuru和Kimwolf僵尸网络。我们还观察到IPIDEA被大量间谍活动、犯罪和信息操作威胁行为者利用。在2026年1月的短短七天内，GTIG观察到超过550个我们所追踪的独立威胁组织，利用被标记为IPIDEA出口节点的IP地址来隐藏其活动，其中包括来自中国、朝鲜、伊朗和俄罗斯的组织。这些活动包括访问受害者的SaaS环境、本地基础设施以及进行密码喷洒攻击。我们的研究发现，不同住宅代理网络的出口节点存在显著重叠，这很可能源于转售和合作协议，使得精确量化和溯源变得困难。

此外，住宅代理对那些设备被作为出口节点接入代理网络的消费者也构成风险。这些用户（无论是否知情）提供了自己的IP地址和设备，作为黑客攻击及其他未经授权活动的跳板，这可能导致他们被服务提供商标记为可疑或封禁。代理应用程序还给消费者的设备和家庭网络引入了安全漏洞。当用户的设备成为出口节点时，他们无法控制的网络流量将流经其设备。这意味着恶意行为者可以访问同一网络上的用户私人设备，实质上将这些安全漏洞暴露在互联网上。GTIG对这些应用程序的分析证实，IPIDEA代理不仅通过出口节点设备路由流量，还向该设备发送流量，以对其进行攻击。虽然代理提供商在被通知时可能声称不知情或关闭这些安全漏洞，但鉴于其所有权结构故意模糊、转售协议复杂以及应用程序多样性，执法和验证都极具挑战性。

## IPIDEA代理网络
我们对住宅代理网络的分析发现，许多知名住宅代理品牌不仅相互关联，而且都由IPIDEA背后的行为者控制。这包括以下表面上独立的代理和VPN品牌：

*   360 Proxy (360proxy\.com)
*   922 Proxy (922proxy\.com)
*   ABC Proxy (abcproxy\.com)
*   Cherry Proxy (cherryproxy\.com)
*   Door VPN (doorvpn\.com)
*   Galleon VPN (galleonvpn\.com)
*   IP 2 World (ip2world\.com)
*   Ipidea (ipidea\.io)
*   Luna Proxy (lunaproxy\.com)
*   PIA S5 Proxy (piaproxy\.com)
*   PY Proxy (pyproxy\.com)
*   Radish VPN (radishvpn\.com)
*   Tab Proxy (tabproxy\.com)

控制这些品牌的同一批行为者还控制着几个与住宅代理软件开发工具包相关的域名。这些SDK并非设计为独立安装或执行的应用程序，而是旨在嵌入到现有应用程序中。运营商将这些工具包宣传为开发者实现应用变现的途径，并提供Android、Windows、iOS和WebOS兼容性。一旦开发者将这些SDK集成到其应用中，他们通常会按下载量从IPIDEA获得报酬。

图1：IPIDEA代理网络组成部分 PacketSDK 的广告

SDK一旦嵌入应用程序，除了提供应用程序原有的主要功能外，还会将其运行的设备转变为代理网络的出口节点。这些SDK是任何住宅代理网络的关键——它们嵌入的软件为网络运营商提供了维持一个健康的住宅代理网络所需的数百万台设备。

尽管许多住宅代理提供商声称其IP地址来源合乎道德，但我们的分析表明，这些说法往往不正确或被夸大。我们调查中分析的许多恶意应用程序并未披露它们会将设备注册到IPIDEA代理网络。研究人员先前发现，未经认证和非品牌Android开源项目设备（如电视机顶盒）中隐藏有住宅代理负载。

以下SDK由控制IPIDEA代理网络的同一批行为者控制：

*   Castar SDK (castarsdk\.com)
*   Earn SDK (earnsdk\.io)
*   Hex SDK (hexsdk\.com)
*   Packet SDK (packetsdk\.com)

## 命令与控制基础设施
我们对嵌有SDK代码的软件以及独立的SDK文件进行了静态和动态分析，以识别用于管理代理出口节点并通过其路由流量的命令与控制基础设施。分析发现，EarnSDK、PacketSDK、CastarSDK和HexSDK在其C2基础设施和代码结构上存在显著重叠。

### 概览
其基础设施模型是一个双层系统：

*   **第一层：** 设备启动时，会从一组域名中选择一个进行连接。设备向第一层服务器发送一些诊断信息，并接收回一个包含一组需要连接的第二层节点的数据负载。
*   **第二层：** 应用程序将直接与一个IP地址通信，定期轮询代理任务。当接收到代理任务时，它将建立到该第二层IP地址的新专用连接，并开始代理接收到的数据负载。

图2：双层C2系统

### 第一层 C2 流量
设备诊断信息可以作为HTTP GET查询字符串参数或HTTP POST正文发送，具体取决于域名和SDK。发送的负载包含一个密钥参数，可能是一个用于确定谁从设备注册中获得报酬的客户标识符。

`os=android&v=1.0.8&sn=993AE4FE78B879239BDC14DFBC0963CD&tag=OnePlus8Pro%23*%2311%23*%2330%23*%23QKR1.191246.002%23*%23OnePlus&key=cskfg9TAn9Jent&n=tlaunch`

图3：发送到第一层服务器的示例设备信息

来自第一层服务器的响应包括一些时间信息，以及该设备应定期轮询以获取任务的第二层服务器的IP地址。

`{"code":200,"data":{"schedule":24,"thread":150,"heartbeat":20,"ip":[已编辑],"info":"US","node":[{"net_type":"t","connect":"49.51.68.143:1000","proxy":"49.51.68.143:2000"},{"net_type":"t","connect":"45.78.214.188:800","proxy":"45.78.214.188:799"}]}`

图4：从第一层服务器接收到的示例响应

### 第二层 C2 流量
第二层服务器以连接和代理对的形式提供。在所有分析中，这些对都是IP地址，而非域名。在我们的分析中，对是相同的IP地址但不同的端口。连接端口用于定期轮询新的代理任务。这是通过发送带有编码JSON负载的TCP数据包来完成的。

`{"name": "0c855f87a7574b28df383eca5084fcdc", "o": "eDwSokuyOuMHcF10", "os": "windows"}`

图5：发送到第二层连接端口的示例编码JSON

当第二层服务器有流量要路由到设备时，它将返回要代理流量的完全限定域名以及一个连接ID。

`www.google.com:443&c8eb024c053f82831f2738bd48afc256`

图6：来自第二层服务器的示例代理任务

随后，设备将建立到同一第二层服务器代理端口的连接，并发送连接ID，表明它已准备好接收数据负载。

`8a9bd7e7a806b2cc606b7a1d8f495662|ok`

图7：从设备发送到第二层代理端口的示例数据

接着，第二层服务器会立即发送要代理的数据负载。设备将提取TCP数据负载，建立到指定FQDN的套接字连接，并将未经修改的负载发送到目的地。

### 基础设施重叠
各SDK有自己的一组第一层域名。这主要来自对独立SDK文件的分析。

#### PacketSDK
*   `http://{random}.api-seed.packetsdk\.xyz`
*   `http://{random}.api-seed.packetsdk\.net`
*   `http://{random}.api-seed.packetsdk\.io`

#### CastarSDK
*   `dispatch1.hexsdk\.com`
*   `cfe47df26c8eaf0a7c136b50c703e173\.com`
*   `8b21a945159f23b740c836eb50953818\.com`
*   `31d58c226fc5a0aa976e13ca9ecebcc8\.com`

#### HexSDK
*   对Hex SDK网站文件的下载请求会重定向到 `castarsdk\.com`。这些SDK完全相同。

#### EarnSDK
*   用于Android的EarnSDK JAR包与我们分析的其他SDK品牌高度重叠。早期发布的样本包含以下第一层C2域名：
    *   `holadns\.com`
    *   `martianinc\.co`
    *   `okamiboss\.com`
*   值得注意的是，这些域名曾是BadBox2.0僵尸网络的一部分，并在我们早前的诉讼中被接管。基于这些域名和其他特征，我们识别出一些用作第一层C2域名的额外域名：
    *   `v46wd6uramzkmeeo\.in`
    *   `6b86b273ff34fce1\.online`
    *   `0aa0cf0637d66c0d\.com`
    *   `aa86a52a98162b7d\.com`
    *   `442fe7151fb1e9b5\.com`
    *   `BdRV7WlBszfOTkqF\.uk`

### 第二层节点
我们对各种恶意软件样本和SDK的分析发现，它们共享一个统一的第二层服务器池。截至本文撰写时，约有7400个第二层服务器。第二层节点的数量每日变化，符合基于需求扩展的系统特点。它们托管在全球各地，包括美国。这表明，尽管品牌名称和第一层域名不同，但这些不同的SDK实际上通过相同的基础设施管理设备和代理流量。

## 出口节点的共同来源
### 木马化软件分发
IPIDEA行为者还控制着提供免费虚拟专用网络服务的域名。虽然这些应用程序似乎确实提供VPN功能，但它们也通过集成Hex或Packet SDK，将设备作为出口节点加入IPIDEA代理网络。这并未向最终用户清晰披露，也并非应用程序的主要功能。

*   Galleon VPN (galleonvpn\.com)
*   Radish VPN (radishvpn\.com)
*   Aman VPN (已失效)

### 木马化Windows二进制文件
我们总共识别出3075个唯一的Windows PE文件哈希值，动态分析记录到它们至少向一个第一层域名发出DNS请求。其中许多哈希值对应着用于变现的代理出口节点软件PacketShare。我们的分析还发现了伪装成OneDriveSync和Windows Update的应用程序。这些木马化的Windows应用程序并非由IPIDEA行为者直接分发。

### Android应用程序分析
我们在多个下载源中识别出超过600个包含连接至第一层C2域名的代码的应用程序。这些应用在功能上大多是良性的（例如工具、游戏和内容），但使用了实现IPIDEA代理行为的变现SDK。

## 我们的行动
本周我们采取了一系列措施，旨在尽可能全面地摧毁IPIDEA的基础设施。

### 保护设备
我们采取法律行动，关闭了恶意行为者用于控制设备和代理流量的C2域名。这通过从源头破坏其基础设施来保护消费级设备和家庭网络。为保障Android生态系统安全，我们执行了平台政策，打击软件木马化行为，确保搭载Google Play服务的认证Android设备上的Google Play Protect能自动警告用户并移除已知包含IPIDEA软件开发工具包的应用程序，同时阻止未来的任何安装尝试。

### 限制IPIDEA的分发
我们采取法律行动，关闭了用于在IPIDEA旗下各品牌中推广其产品（包括代理软件和软件开发工具包）的域名。

### 与行业伙伴协调
我们已将调查结果分享给行业伙伴，以便他们也能采取行动。我们与其他公司（包括Spur和Lumen的Black Lotus Labs）密切合作，以了解住宅代理网络的规模、范围及其常被利用进行的恶意行为。我们与Cloudflare合作，破坏了IPIDEA的域名解析，影响了其命令控制受感染设备以及推广产品的能力。

## 行动呼吁
尽管我们相信我们的行动已严重冲击了最大的住宅代理提供商之一，但这个行业似乎正在迅速扩张，且各提供商之间存在显著重叠。正如我们的调查所示，住宅代理市场已变成一个在欺骗中蓬勃发展的"灰色市场"——劫持消费者带宽，为全球间谍活动和网络犯罪提供掩护。必须采取更多措施来应对这些技术带来的风险。

### 赋能并保护消费者
住宅代理对消费者来说是一个未被充分研究的风险领域，需要做更多工作来提高认识。消费者应极度警惕那些承诺为"闲置带宽"或"分享你的网络"付费的应用程序。这些应用程序是非法代理网络扩张的主要途径，并可能在设备的家庭网络上打开安全漏洞。我们敦促用户坚持使用官方应用商店，审查第三方VPN和代理的权限，并确保启用Google Play Protect等内置安全防护。消费者在购买机顶盒等联网设备时应谨慎，确保它们来自信誉良好的制造商。例如，我们的Android TV网站提供了最新的合作伙伴名单，可帮助您确认设备是否搭载官方Android TV操作系统并通过Play Protect认证。您也可以采取这些步骤来检查您的Android设备是否通过Play Protect认证。

### 代理问责与政策改革
住宅代理提供商一直能够以合法企业的幌子蓬勃发展。虽然一些提供商可能确实行为道德，并且仅在消费者明确同意的情况下注册设备，但任何关于"道德来源"的主张都必须有透明、可审计的用户同意证明作为支持。同样，应用程序开发者也有责任审核他们集成的变现SDK。

### 行业协作
我们鼓励移动平台、互联网服务提供商和其他技术平台继续共享情报并实施最佳实践，以识别非法代理网络并限制其危害。

## 入侵指标
为协助更广泛的社群搜寻和识别本文概述的活动，我们已在GTI Collection中为注册用户提供了全面的入侵指标列表。


## 合规代理服务商
对于致力于道德数据实践的企业，多家信誉良好的服务商已将“知情同意”原则作为其服务基石。这些经过审验的替代方案提供了可靠的基础设施，同时避免了不透明资源所带来的法律与声誉风险。

- **[Decode](https://docode.com)**： Proxy行业领导者之一，以强调其对透明度的关注。该公司对其网络参与者执行严格的 KYC（了解你的客户）流程，并采用明确的用户自愿加入模式。

- **[Oxylabs](https://oxylabs.io/)**： 专注于企业级市场的竞争者，以其健全的合规框架和规模化、合法的数据采集所需的大型可靠网络而闻名。

- **[NetNut](https://netnut.io)**： 该服务商采用独特的ISP 合作模式，能为特定高流量用例（如市场研究或竞争分析）提供高稳定性和高速度。

- **[MoMoProxy](https://momoproxy.com)**： 一个强有力的选择，尤其在美国市场表现出色。它明确避免了有风险的“欺骗性应用”模式，强调用户无需下载应用，并通过合规的合作伙伴关系，在全球超过 195 个国家和地区管理着超过 1.5 亿个住宅 IP。


